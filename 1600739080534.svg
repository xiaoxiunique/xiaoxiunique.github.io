<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="651px" preserveAspectRatio="none" style="width:1154px;height:651px;" version="1.1" viewBox="0 0 1154 651" width="1154px" zoomAndPan="magnify"><defs><filter height="300%" id="f18kg5puoh05kc" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="31" x2="31" y1="41.1201" y2="608.1904"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="182.5" x2="182.5" y1="41.1201" y2="608.1904"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="400" x2="400" y1="41.1201" y2="608.1904"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="614" x2="614" y1="41.1201" y2="608.1904"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="712" x2="712" y1="41.1201" y2="608.1904"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="796" x2="796" y1="41.1201" y2="608.1904"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="968" x2="968" y1="41.1201" y2="608.1904"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1127" x2="1127" y1="41.1201" y2="608.1904"/><rect fill="#FEFECE" filter="url(#f18kg5puoh05kc)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="42" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="15" y="26.0439">user</text><rect fill="#FEFECE" filter="url(#f18kg5puoh05kc)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="42" x="8" y="607.1904"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="15" y="630.2344">user</text><rect fill="#FEFECE" filter="url(#f18kg5puoh05kc)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="41" x="160.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="167.5" y="26.0439">BFF</text><rect fill="#FEFECE" filter="url(#f18kg5puoh05kc)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="41" x="160.5" y="607.1904"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="167.5" y="630.2344">BFF</text><rect fill="#FEFECE" filter="url(#f18kg5puoh05kc)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="363" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="370" y="26.0439">营销网关</text><rect fill="#FEFECE" filter="url(#f18kg5puoh05kc)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="363" y="607.1904"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="370" y="630.2344">营销网关</text><rect fill="#FEFECE" filter="url(#f18kg5puoh05kc)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="563" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="570" y="26.0439">商城地址服务</text><rect fill="#FEFECE" filter="url(#f18kg5puoh05kc)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="563" y="607.1904"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="570" y="630.2344">商城地址服务</text><rect fill="#FEFECE" filter="url(#f18kg5puoh05kc)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="675" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="682" y="26.0439">阿里风控</text><rect fill="#FEFECE" filter="url(#f18kg5puoh05kc)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="675" y="607.1904"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="682" y="630.2344">阿里风控</text><rect fill="#FEFECE" filter="url(#f18kg5puoh05kc)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="759" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="766" y="26.0439">营销中台</text><rect fill="#FEFECE" filter="url(#f18kg5puoh05kc)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="759" y="607.1904"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="766" y="630.2344">营销中台</text><rect fill="#FEFECE" filter="url(#f18kg5puoh05kc)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="931" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="938" y="26.0439">支付中台</text><rect fill="#FEFECE" filter="url(#f18kg5puoh05kc)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="931" y="607.1904"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="938" y="630.2344">支付中台</text><rect fill="#FEFECE" filter="url(#f18kg5puoh05kc)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="36" x="1107" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="22" x="1114" y="26.0439">MQ</text><rect fill="#FEFECE" filter="url(#f18kg5puoh05kc)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="36" x="1107" y="607.1904"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="22" x="1114" y="630.2344">MQ</text><polygon fill="#A80036" points="171,70.8745,181,74.8745,171,78.8745,175,74.8745" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="31" x2="177" y1="74.8745" y2="74.8745"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="38" y="70.0181">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="49" y="70.0181">用户秒杀订单</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="183" x2="225" y1="106.6289" y2="106.6289"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="225" x2="225" y1="106.6289" y2="119.6289"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="184" x2="225" y1="119.6289" y2="119.6289"/><polygon fill="#A80036" points="194,115.6289,184,119.6289,194,123.6289,190,119.6289" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="190" y="101.7725">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="201" y="101.7725">判断用户是否绑定设备</text><polygon fill="#A80036" points="388,147.3833,398,151.3833,388,155.3833,392,151.3833" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="183" x2="394" y1="151.3833" y2="151.3833"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="190" y="146.5269">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="201" y="146.5269">提交秒杀订单</text><polygon fill="#A80036" points="602,179.1377,612,183.1377,602,187.1377,606,183.1377" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="400" x2="608" y1="183.1377" y2="183.1377"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="407" y="178.2813">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="418" y="178.2813">判断用户收货地址是否存在</text><polygon fill="#A80036" points="700,210.8921,710,214.8921,700,218.8921,704,214.8921" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="400" x2="706" y1="214.8921" y2="214.8921"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="407" y="210.0356">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="418" y="210.0356">判断用户手机号/收货地址/IP 地址风险</text><polygon fill="#A80036" points="194,242.6465,184,246.6465,194,250.6465,190,246.6465" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="188" x2="399" y1="246.6465" y2="246.6465"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="200" y="241.79">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="211" y="241.79">如果存在风险，提示用户已售罄</text><polygon fill="#A80036" points="42,274.4009,32,278.4009,42,282.4009,38,278.4009" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="36" x2="182" y1="278.4009" y2="278.4009"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="48" y="273.5444">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="59" y="273.5444">提示用户商品已售罄</text><polygon fill="#A80036" points="784,306.1553,794,310.1553,784,314.1553,788,310.1553" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="400" x2="790" y1="310.1553" y2="310.1553"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="407" y="305.2988">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="418" y="305.2988">调用下单接口</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="796" x2="838" y1="341.9097" y2="341.9097"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="838" x2="838" y1="341.9097" y2="354.9097"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="797" x2="838" y1="354.9097" y2="354.9097"/><polygon fill="#A80036" points="807,350.9097,797,354.9097,807,358.9097,803,354.9097" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="803" y="337.0532">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="814" y="337.0532">判断活动状态/库存等信息</text><polygon fill="#A80036" points="411,382.6641,401,386.6641,411,390.6641,407,386.6641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="405" x2="795" y1="386.6641" y2="386.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="417" y="381.8076">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="435" y="381.8076">返回下单结果</text><polygon fill="#A80036" points="194,414.4185,184,418.4185,194,422.4185,190,418.4185" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="188" x2="399" y1="418.4185" y2="418.4185"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="200" y="413.562">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="218" y="413.562">返回下单结果</text><polygon fill="#A80036" points="42,446.1729,32,450.1729,42,454.1729,38,450.1729" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="36" x2="182" y1="450.1729" y2="450.1729"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="48" y="445.3164">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="66" y="445.3164">返回下单结果</text><polygon fill="#A80036" points="956,477.9272,966,481.9272,956,485.9272,960,481.9272" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="31" x2="962" y1="481.9272" y2="481.9272"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="38" y="477.0708">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="56" y="477.0708">下单成功，拉起支付</text><polygon fill="#A80036" points="1115,509.6816,1125,513.6816,1115,517.6816,1119,513.6816" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="968" x2="1121" y1="513.6816" y2="513.6816"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="975" y="508.8252">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="993" y="508.8252">支付成功，投递消息</text><polygon fill="#A80036" points="411,541.436,401,545.436,411,549.436,407,545.436" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="405" x2="1126" y1="545.436" y2="545.436"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="417" y="540.5796">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="435" y="540.5796">消费消息</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="400" x2="442" y1="577.1904" y2="577.1904"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="442" x2="442" y1="577.1904" y2="590.1904"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="401" x2="442" y1="590.1904" y2="590.1904"/><polygon fill="#A80036" points="411,586.1904,401,590.1904,411,594.1904,407,590.1904" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="407" y="572.334">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="425" y="572.334">扣减真实库存，并修改订单状态</text><!--MD5=[de690bccde8421b0ef329b7794868fb4]
@startuml
autonumber
participant user
user -> BFF: 用户秒杀订单
BFF -> BFF: 判断用户是否绑定设备
BFF -> 营销网关: 提交秒杀订单
营销网关 -> 商城地址服务: 判断用户收货地址是否存在
营销网关 -> 阿里风控: 判断用户手机号/收货地址/IP 地址风险
营销网关 - -> BFF: 如果存在风险，提示用户已售罄
BFF - -> user: 提示用户商品已售罄
营销网关 -> 营销中台: 调用下单接口
营销中台 - -> 营销中台: 判断活动状态/库存等信息
营销中台 - -> 营销网关: 返回下单结果
营销网关 - -> BFF: 返回下单结果
BFF - -> user: 返回下单结果
user -> 支付中台: 下单成功，拉起支付
支付中台 -> MQ: 支付成功，投递消息
MQ - -> 营销网关: 消费消息
营销网关 - -> 营销网关: 扣减真实库存，并修改订单状态
@enduml

PlantUML version 1.2020.10(Sun May 17 17:35:57 CST 2020)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Java Version: 1.8.0_91-b14
Operating System: Windows 10
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg>